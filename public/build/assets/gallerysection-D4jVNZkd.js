document.addEventListener("DOMContentLoaded",function(){const l=document.getElementById("gallery-wrapper"),s=document.getElementById("galleryModal");if(!l||!s)return;const o=new bootstrap.Modal(s);async function i(){try{const e=await fetch("/api/public-gallery",{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}}),n=e.headers.get("content-type");if(n&&n.includes("text/html")){console.error("The server returned HTML instead of JSON. Check your routes."),l.innerHTML=`
                    <div class="text-center text-muted py-5">
                        <p>Gallery configuration error. Please try again later.</p>
                    </div>`;return}if(!e.ok)throw new Error(`HTTP error! status: ${e.status}`);const t=await e.json();if(t.status==="success"){const r=t.data.filter(a=>a.status.toLowerCase()==="active");c(r)}}catch(e){console.error("Gallery Load Error:",e),l.innerHTML='<p class="text-center text-muted">Unable to connect to the gallery database.</p>'}}function c(e){if(!e||e.length===0){l.innerHTML='<p class="text-center text-muted">No active photos to display.</p>';return}let n="";e.forEach(t=>{n+=`
                <div class="swiper-slide" 
                     data-title="${t.title}" 
                     data-desc="${t.description||"Simply delicious bakes."}" 
                     data-img="${t.image_url}">
                    <img src="${t.image_url}" alt="${t.title}" loading="lazy">
                </div>
            `}),l.innerHTML=n,d(),l.addEventListener("click",function(t){const r=t.target.closest(".swiper-slide");r&&p(r.dataset)})}function d(){const e=document.querySelectorAll(".gallery-swiper .swiper-slide").length;new Swiper(".gallery-swiper",{loop:e>3,centeredSlides:!0,slidesPerView:1.2,spaceBetween:10,speed:800,observer:!0,observeParents:!0,autoplay:{delay:3500,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{640:{slidesPerView:2,spaceBetween:15},1024:{slidesPerView:3,spaceBetween:20},1440:{slidesPerView:4,spaceBetween:30}}})}function p(e){const n=document.getElementById("modal-img"),t=document.getElementById("modal-title"),r=document.getElementById("modal-desc");n&&(n.src=e.img),t&&(t.innerText=e.title),r&&(r.innerText=e.desc);const a=s.querySelector(".modal-dialog");a&&!a.classList.contains("modal-dialog-centered")&&a.classList.add("modal-dialog-centered"),o.show()}i()});
